From f38fcbbe0c7522af093f3fbc1cb60d9c926e997d Mon Sep 17 00:00:00 2001
From: Enzo Givernaud <egd@sahar.fr>
Date: Mon, 25 Aug 2025 19:48:13 +0200
Subject: [PATCH] ui: (app) init ui lib

---
 .gitignore                            |  3 ++
 .moon/workspace.yml                   |  1 +
 apps/admin/moon.yml                   | 18 ++++++++----
 apps/admin/package.json               |  6 ++--
 apps/admin/src/router.tsx             |  1 +
 apps/admin/src/routes/index.tsx       |  3 +-
 apps/admin/tsconfig.json              |  1 +
 apps/admin/vite.config.ts             | 42 ++++++++++++++++++---------
 biome.json                            |  2 +-
 package.json                          |  1 +
 packages/ui/moon.yml                  | 20 +++++++++++++
 packages/ui/package.json              | 32 ++++++++++++++++++++
 packages/ui/panda.config.ts           | 12 ++++++++
 packages/ui/src/components/Button.tsx | 26 +++++++++++++++++
 packages/ui/src/components/index.ts   |  1 +
 packages/ui/src/index.ts              |  3 ++
 packages/ui/tsconfig.build.json       | 13 +++++++++
 packages/ui/tsconfig.json             | 11 +++++++
 packages/ui/tsup.config.ts            | 10 +++++++
 tsconfig.base.json                    |  3 +-
 20 files changed, 184 insertions(+), 25 deletions(-)
 create mode 100644 packages/ui/moon.yml
 create mode 100644 packages/ui/package.json
 create mode 100644 packages/ui/panda.config.ts
 create mode 100644 packages/ui/src/components/Button.tsx
 create mode 100644 packages/ui/src/components/index.ts
 create mode 100644 packages/ui/src/index.ts
 create mode 100644 packages/ui/tsconfig.build.json
 create mode 100644 packages/ui/tsconfig.json
 create mode 100644 packages/ui/tsup.config.ts

diff --git a/.gitignore b/.gitignore
index a80b539..18d5fb7 100644
--- a/.gitignore
+++ b/.gitignore
@@ -24,3 +24,6 @@ todos.json
 pnpm-lock.yaml
 build
 .env.*
+
+styled-system
+styled-system-studio
\ No newline at end of file
diff --git a/.moon/workspace.yml b/.moon/workspace.yml
index 8824652..42c6018 100644
--- a/.moon/workspace.yml
+++ b/.moon/workspace.yml
@@ -6,6 +6,7 @@ $schema: './cache/schemas/workspace.json'
 projects:
   api: 'apps/api'
   admin: 'apps/admin'
+  ui: 'packages/ui'
 vcs:
   manager: 'git'
   defaultBranch: 'main'
diff --git a/apps/admin/moon.yml b/apps/admin/moon.yml
index ad4e634..15379bf 100644
--- a/apps/admin/moon.yml
+++ b/apps/admin/moon.yml
@@ -1,22 +1,28 @@
-id: "admin"
+id: admin
 type: application
 language: node
-stack: 'frontend'
+stack: frontend
+
+dependsOn:
+  - api
+  - ui
 
 project:
-  name: 'admin'
-  description: 'Tansatck admin'
-  owner: 'bigzoo'
-  maintainers: ['enzo.givernaud']
+  name: admin
+  description: Tansatck admin
+  owner: bigzoo
+  maintainers: [enzo.givernaud]
 
 tasks:
   dev:
     command: "pnpm dev"
     local: true
+    deps: ["packages:ui:build"]
   build:
     command: "pnpm build"
     outputs:
       - "dist/**"
+    deps: ["packages:ui:build"]
   lint:
     command: "pnpm lint"
   typecheck:
diff --git a/apps/admin/package.json b/apps/admin/package.json
index 7b7738f..fc3b484 100644
--- a/apps/admin/package.json
+++ b/apps/admin/package.json
@@ -4,13 +4,15 @@
   "type": "module",
   "scripts": {
     "dev": "vite dev --port 3000",
-    "start": "node .output/server/index.mjs",
     "build": "vite build",
     "serve": "vite preview",
     "test": "vitest run",
     "format": "biome format",
     "lint": "biome lint && oxlint .",
     "typecheck": "tsc -b --noEmit",
-    "check": "pnpm run lint && check"
+    "check": "pnpm run lint && pnpm run typecheck"
+  },
+  "dependencies": {
+    "@bigzoo/ui": "workspace:*"
   }
 }
\ No newline at end of file
diff --git a/apps/admin/src/router.tsx b/apps/admin/src/router.tsx
index acf7a06..4964941 100644
--- a/apps/admin/src/router.tsx
+++ b/apps/admin/src/router.tsx
@@ -12,6 +12,7 @@ export const createRouter = () => {
   const router = createTanstackRouter({
     routeTree,
     context: { ...rqContext },
+    defaultNotFoundComponent: () => <div>404 â€“ Page non trouvÃ©e ðŸ˜…</div>,
     defaultPreload: 'intent',
     Wrap: (props: { children: React.ReactNode }) => {
       return (
diff --git a/apps/admin/src/routes/index.tsx b/apps/admin/src/routes/index.tsx
index 7e3b069..0fa3080 100644
--- a/apps/admin/src/routes/index.tsx
+++ b/apps/admin/src/routes/index.tsx
@@ -1,4 +1,5 @@
 import { createFileRoute } from "@tanstack/react-router";
+import {Button} from '@bigzoo/ui'
 
 export const Route = createFileRoute("/")({
 	component: App,
@@ -7,7 +8,7 @@ export const Route = createFileRoute("/")({
 function App() {
 	return (
 		<div className="text-center">
-			<p>wesh</p>
+			<Button>wesh</Button>
 		</div>
 	);
 }
diff --git a/apps/admin/tsconfig.json b/apps/admin/tsconfig.json
index fd504de..78df037 100644
--- a/apps/admin/tsconfig.json
+++ b/apps/admin/tsconfig.json
@@ -1,5 +1,6 @@
 {
   "include": ["**/*.ts", "**/*.tsx"],
+  "references": [{ "path": "../../packages/ui" }],
   "extends": "../../tsconfig.base.json",
   "compilerOptions": {
     "paths": {
diff --git a/apps/admin/vite.config.ts b/apps/admin/vite.config.ts
index f2c9213..27f6557 100644
--- a/apps/admin/vite.config.ts
+++ b/apps/admin/vite.config.ts
@@ -2,29 +2,43 @@ import { defineConfig } from 'vite'
 import { tanstackStart } from '@tanstack/react-start/plugin/vite'
 import viteReact from '@vitejs/plugin-react'
 import viteTsConfigPaths from 'vite-tsconfig-paths'
-import tailwindcss from '@tailwindcss/vite'
-
-import { wrapVinxiConfigWithSentry } from '@sentry/tanstackstart-react'
+import path from 'node:path'
 
 const config = defineConfig({
   plugins: [
-    // this is the plugin that enables path aliases
-    viteTsConfigPaths({
+    viteTsConfigPaths(  {
       projects: ['./tsconfig.json'],
     }),
-    tailwindcss(),
     tanstackStart({
       customViteReactPlugin: true,
     }),
     viteReact(),
   ],
+  resolve: {
+    alias: [
+      {
+        find: /^@styled-system\/(.*)$/,
+        replacement: path.resolve(__dirname, '../../packages/ui/styled-system/$1'),
+      },
+      {
+        find: /^@styled-system$/,
+        replacement: path.resolve(__dirname, '../../packages/ui/styled-system'),
+      },
+    ],
+  },
+  optimizeDeps: {
+    disabled: "dev",
+  exclude: ['@bigzoo/ui', '@styled-system/jsx'],
+},
+ssr: {
+  noExternal: ['@bigzoo/ui'], 
+},
+server: {
+  fs: {
+    allow: ['..', '../../packages/ui'],
+  },
+},
 })
 
-export default wrapVinxiConfigWithSentry(config, {
-  org: process.env.VITE_SENTRY_ORG,
-  project: process.env.VITE_SENTRY_PROJECT,
-  authToken: process.env.SENTRY_AUTH_TOKEN,
-  // Only print logs for uploading source maps in CI
-  // Set to `true` to suppress logs
-  silent: !process.env.CI,
-})
+export default config
+
diff --git a/biome.json b/biome.json
index 2e91202..ba80f3a 100644
--- a/biome.json
+++ b/biome.json
@@ -7,7 +7,7 @@
   },
   "files": {
     "ignoreUnknown": false,
-    "ignore": ["src/routeTree.gen.ts"],
+    "ignore": ["src/routeTree.gen.ts", "**/node_modules/**", "**/dist/**", "**/build/**", "packages/ui/src/styled-system/**"],
     "include": ["src/*", ".vscode/*", "index.html", "vite.config.js"]
   },
   "formatter": {
diff --git a/package.json b/package.json
index 9e2e4e2..eea896c 100644
--- a/package.json
+++ b/package.json
@@ -33,6 +33,7 @@
   },
   "devDependencies": {
     "@biomejs/biome": "1.9.4",
+    "@pandacss/dev": "^1.1.0",
     "@tanstack/devtools-event-client": "^0.2.1",
     "@testing-library/dom": "^10.4.0",
     "@testing-library/react": "^16.2.0",
diff --git a/packages/ui/moon.yml b/packages/ui/moon.yml
new file mode 100644
index 0000000..e170f48
--- /dev/null
+++ b/packages/ui/moon.yml
@@ -0,0 +1,20 @@
+id: ui
+type: library
+language: node
+stack: frontend
+
+project:
+  name: ui
+  description: Design System
+  owner: bigzoo
+  maintainers: [enzo.givernaud]
+
+tasks:
+  build:
+    command: "pnpm build"
+    outputs: ["src/styled-system/**", 'dist/**']
+    local: true
+  lint:
+    command: "pnpm lint"
+  typecheck:
+    command: "pnpm typecheck"
diff --git a/packages/ui/package.json b/packages/ui/package.json
new file mode 100644
index 0000000..35ed248
--- /dev/null
+++ b/packages/ui/package.json
@@ -0,0 +1,32 @@
+{
+  "name": "@bigzoo/ui",
+  "private": true,
+  "type": "module",
+  "version": "0.0.0",
+  "exports": {
+    ".": {
+      "types": "./src/index.ts",
+      "import": "./src/index.ts"
+    },
+    "./styled-system/*": {
+      "types": "./styled-system/*",
+      "import": "./styled-system/*"
+    }
+  },
+  "scripts": {
+    "panda:codegen": "panda codegen",
+    "panda:watch": "panda codegen --watch",
+    "build": "pnpm panda:codegen  && tsup",
+    "format": "biome format",
+    "lint": "biome lint && oxlint .",
+    "typecheck": "tsc -b --noEmit",
+    "check": "pnpm lint && pnpm typecheck"
+  },
+  "peerDependencies": {
+    "react": "^18 || ^19",
+    "react-dom": "^18 || ^19"
+  },
+  "devDependencies": {
+    "tsup": "^8.5.0"
+  }
+}
diff --git a/packages/ui/panda.config.ts b/packages/ui/panda.config.ts
new file mode 100644
index 0000000..666785c
--- /dev/null
+++ b/packages/ui/panda.config.ts
@@ -0,0 +1,12 @@
+import { defineConfig } from "@pandacss/dev";
+
+export default defineConfig({
+  jsxFramework: 'react',
+  preflight: true,
+  include: ["./src/**/*.{js,jsx,ts,tsx,astro}"],
+  exclude: [],
+  theme: {
+    extend: {},
+  },
+  outdir: "styled-system",
+});
diff --git a/packages/ui/src/components/Button.tsx b/packages/ui/src/components/Button.tsx
new file mode 100644
index 0000000..5759d35
--- /dev/null
+++ b/packages/ui/src/components/Button.tsx
@@ -0,0 +1,26 @@
+import { styled } from "@styled-system/jsx";
+
+export const Button = styled('button', {
+  base: {
+    px: 3,
+    py: 2,
+    rounded: 'lg',
+    fontWeight: 'semibold',
+    borderWidth: '1px',
+    _hover: { bg: 'gray.100' }
+  },
+  variants: {
+    intent: {
+      primary: { bg: 'blue.600', color: 'white', _hover: { bg: 'blue.700' } },
+      ghost: { bg: 'transparent' }
+    },
+    size: {
+      sm: { textStyle: 'sm' },
+      md: { textStyle: 'md' }
+    }
+  },
+  defaultVariants: {
+    intent: 'primary',
+    size: 'md'
+  }
+})
diff --git a/packages/ui/src/components/index.ts b/packages/ui/src/components/index.ts
new file mode 100644
index 0000000..55dd47d
--- /dev/null
+++ b/packages/ui/src/components/index.ts
@@ -0,0 +1 @@
+export {Button} from './Button'
\ No newline at end of file
diff --git a/packages/ui/src/index.ts b/packages/ui/src/index.ts
new file mode 100644
index 0000000..f55544f
--- /dev/null
+++ b/packages/ui/src/index.ts
@@ -0,0 +1,3 @@
+export * from './components'
+export * from '@styled-system/jsx'
+export * from '@styled-system/css'
\ No newline at end of file
diff --git a/packages/ui/tsconfig.build.json b/packages/ui/tsconfig.build.json
new file mode 100644
index 0000000..f217b1b
--- /dev/null
+++ b/packages/ui/tsconfig.build.json
@@ -0,0 +1,13 @@
+{
+  
+  "compilerOptions": {
+    "module": "ESNext", 
+    "outDir": "dist", 
+    "emitDeclarationOnly": true,
+    "declaration": true,
+    "allowImportingTsExtensions": false,
+    "noEmit": false,
+    "declarationDir": "dist"
+  },
+  "include": ["src", "panda.config.ts", "styled-system"]
+}
diff --git a/packages/ui/tsconfig.json b/packages/ui/tsconfig.json
new file mode 100644
index 0000000..d16e4e8
--- /dev/null
+++ b/packages/ui/tsconfig.json
@@ -0,0 +1,11 @@
+{
+  "extends": ["../../tsconfig.base.json", "./tsconfig.build.json"],
+  "compilerOptions": {
+    "composite": true,
+    "outDir": "dist",
+    "baseUrl": ".",
+    "paths": {
+      "@styled-system/*": ["styled-system/*"]
+    }
+  },
+}
diff --git a/packages/ui/tsup.config.ts b/packages/ui/tsup.config.ts
new file mode 100644
index 0000000..11fd393
--- /dev/null
+++ b/packages/ui/tsup.config.ts
@@ -0,0 +1,10 @@
+import { defineConfig } from 'tsup'
+
+export default defineConfig({
+  entry: ['src/index.ts'],
+  dts: true,
+  format: ['esm'],
+  sourcemap: true,
+  clean: true,
+  outDir: 'dist',
+})
diff --git a/tsconfig.base.json b/tsconfig.base.json
index 863ee8c..0377c82 100644
--- a/tsconfig.base.json
+++ b/tsconfig.base.json
@@ -24,7 +24,8 @@
     "noUncheckedIndexedAccess": true,
     "exactOptionalPropertyTypes": true,
     "paths": {
-      "@ui/*": ["packages/ui/src/*"]
+      "@bigzoo/ui": ["packages/ui/src/index.ts"],
+      "@styled-system/*": ["packages/ui/styled-system/*"]
     }
   }
 }
-- 
2.39.5 (Apple Git-154)

